import{_ as S,r as D,E as x,q as V,c as i,a,t,D as u,b as d,d as m,v as f,w as A,o as p,S as X}from"./app-DpBHsqIn.js";const F={class:"my-2"},j={class:"d-block mb-2 mb-lg-3 fs-4 fw-bold"},M={class:"bg-white rounded-2 p-2 theme-shadow col-8 mx-auto"},L={class:"text-center mb-4 rounded-2 p-4 position-relative",style:{background:"#F1F5F9"}},R={class:"position-relative d-inline-block"},T=["src"],q={for:"upload-pp",class:"px-5 py-2 w-100 mt-3",style:{border:"2px dashed #9e4aed",cursor:"pointer"}},z={class:"mt-2 virified-badge"},H={key:0,class:"badge bg-success px-3 py-2"},I={key:1,class:"badge bg-danger px-3 py-2"},O={key:0,class:"my-2 text-danger"},G={class:"row g-3"},J={class:"col-md-6"},K={class:"form-label fs-6"},Q=["placeholder"],W={key:0,class:"my-1 text-danger"},Y={class:"col-md-6"},Z={class:"form-label fs-6"},ee={key:0,class:"my-1 text-danger"},se={class:"col-md-6"},ae={class:"form-label fs-6"},oe={key:0,class:"my-1 text-danger"},te={class:"col-md-6"},le={class:"form-label fs-6"},re=["placeholder"],ne={key:0,class:"my-1 text-danger"},de={class:"col-md-6"},ie={class:"form-label fs-6"},pe=["placeholder"],ce={key:0,class:"my-1 text-danger"},ue={class:"col-md-6"},me={class:"form-label fs-6"},fe=["placeholder"],_e={class:"mt-4"},he={type:"submit",class:"btn btn-primary w-100 py-2 fs-5"},ve={__name:"DashboardProfile",setup(we){let l=D("");const c=x();let C=D("");const s=D({name:c.userData.name,phone:c.userData.phone,email:c.userData.email,current_password:null,password:null,password_confirmation:null,profile_picture:null});V(()=>s.value.name,e=>{e&&(l.value.name="")}),V(()=>s.value.email,e=>{e&&(l.value.email="")}),V(()=>s.value.phone,e=>{e&&(l.value.phone="")}),V(()=>s.value.password,e=>{e&&(l.value.password="")}),V(()=>s.value.current_password,e=>{e&&(C.value="")});const B=async()=>{var e,r,_,h,v,w,b,g,y,$,k,P;try{let o=new FormData;o.append("name",s.value.name),o.append("phone",s.value.phone),s.value.profile_picture&&o.append("profile_picture",s.value.profile_picture),(s.value.current_password||s.value.password||s.value.password_confirmation)&&(o.append("current_password",s.value.current_password),o.append("password",s.value.password),o.append("password_confirmation",s.value.password_confirmation)),s.value.email&&o.append("email",s.value.email);const n=await axios.post("/profile/update",o,{headers:{Accept:"application/json",Authorization:"Bearer "+c.authToken}});c.setAuthData(n.data.data.token,n.data.data.user),X.fire({icon:"success",title:"Success",text:"Profile updated successfully",showConfirmButton:!1,timer:1500})}catch(o){(_=(r=(e=o==null?void 0:o.response)==null?void 0:e.data)==null?void 0:r.data)!=null&&_.current_password_error&&(C.value=(w=(v=(h=o==null?void 0:o.response)==null?void 0:h.data)==null?void 0:v.data)==null?void 0:w.current_password_error),l.value=(g=(b=o==null?void 0:o.response)==null?void 0:b.data)==null?void 0:g.errors,X.fire({icon:"error",title:"Error",text:o.response.data.message,showConfirmButton:!1,timer:1500}),($=(y=o==null?void 0:o.response)==null?void 0:y.data)!=null&&$.access_denied&&X.fire({icon:"error",title:"Access Denied",text:(P=(k=o==null?void 0:o.response)==null?void 0:k.data)==null?void 0:P.access_denied,showConfirmButton:!1,timer:3500})}},U=D(!1);let E=D(!1);const N=e=>{U.value=URL.createObjectURL(e.target.files[0]),s.value.profile_picture=e.target.files[0],E.value=!0};return(e,r)=>{var _,h,v,w,b,g,y,$,k,P,o;return p(),i("section",F,[a("span",j,t(e.$t("Home"))+"/"+t(e.$t("Profile")),1),a("form",{onSubmit:A(B,["prevent"]),class:"row"},[a("div",M,[a("div",L,[a("div",R,[a("img",{src:U.value?U.value:d(c).userData.profile_picture,alt:"Profile picture",height:"120",width:"120",class:"rounded-circle border border-3 border-primary object-fit-cover"},null,8,T),a("input",{id:"upload-pp",type:"file",class:"d-none",onChange:N},null,32),a("label",q,t(e.$t("Change Photo")),1)]),a("div",z,[(_=d(c).userData)!=null&&_.email_verified?(p(),i("span",H,"✔ "+t(e.$t("Verified")),1)):(p(),i("span",I,"✘ "+t(e.$t("Not Verified")),1))]),(h=d(l))!=null&&h.profile_picture?(p(),i("p",O,t((v=d(l))==null?void 0:v.profile_picture[0]),1)):u("",!0)]),a("div",G,[a("div",J,[a("label",K,t(e.$t("Name")),1),m(a("input",{type:"text",class:"form-control bg-light border","onUpdate:modelValue":r[0]||(r[0]=n=>s.value.name=n),placeholder:e.$t("Full Name")},null,8,Q),[[f,s.value.name]]),(w=d(l))!=null&&w.name?(p(),i("p",W,t((b=d(l))==null?void 0:b.name[0]),1)):u("",!0)]),a("div",Y,[a("label",Z,t(e.$t("Mobile Number")),1),m(a("input",{type:"tel",class:"form-control bg-light border","onUpdate:modelValue":r[1]||(r[1]=n=>s.value.phone=n),placeholder:"+8801XXXXXXXXX"},null,512),[[f,s.value.phone]]),(g=d(l))!=null&&g.phone?(p(),i("p",ee,t((y=d(l))==null?void 0:y.phone[0]),1)):u("",!0)]),a("div",se,[a("label",ae,t(e.$t("Email Address")),1),m(a("input",{type:"email",class:"form-control bg-light border","onUpdate:modelValue":r[2]||(r[2]=n=>s.value.email=n),placeholder:"user@example.com"},null,512),[[f,s.value.email]]),($=d(l))!=null&&$.email?(p(),i("p",oe,t((k=d(l))==null?void 0:k.email[0]),1)):u("",!0)]),a("div",te,[a("label",le,t(e.$t("Current Password")),1),m(a("input",{type:"password",class:"form-control bg-light border","onUpdate:modelValue":r[3]||(r[3]=n=>s.value.current_password=n),placeholder:e.$t("Enter current password to change")},null,8,re),[[f,s.value.current_password]]),d(C)?(p(),i("p",ne,t(d(C)),1)):u("",!0)]),a("div",de,[a("label",ie,t(e.$t("New Password")),1),m(a("input",{type:"password",class:"form-control bg-light border","onUpdate:modelValue":r[4]||(r[4]=n=>s.value.password=n),placeholder:e.$t("Enter new password")},null,8,pe),[[f,s.value.password]]),(P=d(l))!=null&&P.password?(p(),i("p",ce,t((o=d(l))==null?void 0:o.password[0]),1)):u("",!0)]),a("div",ue,[a("label",me,t(e.$t("Confirm Password")),1),m(a("input",{type:"password",class:"form-control bg-light border","onUpdate:modelValue":r[5]||(r[5]=n=>s.value.password_confirmation=n),placeholder:e.$t("Confirm new password")},null,8,fe),[[f,s.value.password_confirmation]])])]),a("div",_e,[a("button",he,t(e.$t("Update Profile")),1)])])],32)])}}},ge=S(ve,[["__scopeId","data-v-6d5819e4"]]);export{ge as default};
